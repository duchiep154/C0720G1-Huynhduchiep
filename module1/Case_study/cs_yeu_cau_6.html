<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>yeu cau 6</title>
</head>
<body>
<script>

    let regexEmail = /^\w{3,}@[a-zA-Z]{3,5}\.[a-zA-Z]{2,3}$/;
    let regexID = /^[\d]{9}$/;
    let regexPhoneNumber = /^[\d]{10}$/;
    let regexBirthday = /^((0[1-9])|([1-2][0-9])|(3[0-1]))\/(([0][1-9])|(1[0-2]))\/((19[0-9][0-9])|(20[0-1][0-9])|2020)$/;

    let listCustomers=new Array();
    let listEmployers=new Array();
    let soThuTu;    // check so thu tu customer



    // khai bao class
    class customers {
        constructor(name,id,birthday,email,address,typeCustomer,discount,quantityIncluded,rentDay,typeRoom,serviceRoom) {
            this.name = name;
            this.id = id;
            this.birthday = birthday;
            this.email = email;
            this.address = address;
            this.typeCustomer = typeCustomer;
            this.discount = discount;
            this.quantityIncluded = quantityIncluded;
            this.rentDay = rentDay;
            this.serviceRoom = serviceRoom;
            this.typeRoom = typeRoom;

        }
        setName(name){
            this.name=name;
        }
        getName(){
            return this.name;
        }
        setId(id){
            this.name=id;
        }
        getId(){
            return this.id;
        }
        setBirthday(brithday){
            this.birthday = birthday ;
        }
        getBirthday(){
            return this.birthday;
        }
        setEmail(email){
            this.email = email;
        }
        getEmail(){
            return this.email;
        }
        setAddress(address){
            this.address =address;
        }
        getAddress(){
            return this.address;
        }
        setTypeCustomer(typeCustomer){
            this.typeCustomer= typeCustomer;
        }
        getTypeCustomer(){
            return this.typeCustomer;
        }
        setDiscount(discount){
            this.discount = discount;
        }
        getDiscount(){
            return this.discount;
        }
        setQuantityIncluded(quantityIncluded){
            this.quantityIncluded = quantityIncluded;
        }
        getQuantityIncluded(){
            return this.quantityIncluded;
        }
        setRentDay(rentDay){
            this.rentDay = rentDay;
        }
        getRentDay(){
            return this.rentDay;
        }
        setServiceRoom(serviceRoom){
            this.serviceRoom = serviceRoom;
        }
        getServiceRoom(){
            return this.serviceRoom;
        }
        setTypeRoom(typeroom){
            this.typeRoom=typeroom;
        }
        getTypeRoom(){
            return this.typeRoom
        }
        getInfo() {
            return '1. Tên : ' + this.name + '\n2. Số CMND : ' + this.id + '\n3. Ngày tháng năm sinh : ' + this.birthday +
                '\n4. Email : ' + this.email + '\n5. Địa chỉ : ' + this.address +
                '\n6. Loại Customer : ' + this.typeCustomer +
                '\n7. Giảm giá : ' + this.discount + " % ." +
                '\n8. Số lượng người đi kèm : ' + this.quantityIncluded + '\n9. Số ngày thuê : ' + this.rentDay + " ngày." +
                '\n10. Loại phòng (Villa, House, Room) : ' + this.typeRoom +
                '\n11. Loại dịch vụ phòng (Vip, Business,  Normal) : ' + this.serviceRoom;
        }
        totalPay() {
            let money;
            if (this.typeRoom === "Villa") {
                money = 500;
            } else if (this.typeRoom === "House") {
                money = 300;
            } else if (this.typeRoom === "Room"){
                money = 100;
            }
            return  money * parseInt(this.rentDay) * ( 1 - (parseInt(this.discount) / 100 ));
        }
    }
    class Employee {
        constructor(name,id,birthday,email,phoneNumber,level,position) {
            this.name = name;
            this.id = id;
            this.birthday = birthday;
            this.email = email;
            this.phoneNumber = phoneNumber;
            this.level = level;
            this.position = position;
        }
        setName(name){
            this.name=name;
        }
        setId(id){
            this.id=id;
        }
        setBirthday(birthday){
            this.birthday=birthday;
        }
        setEmail(email){
            this.email=email;
        }
        setPhoneNumber(phoneNumber){
            this.phoneNumber = phoneNumber;
        }
        setLevel(level){
            this.level = level;
        }
        setPosition(position){
            this.position = position;
        }
        getName(){
            return this.name;
        }
        getId(){
            return this.id;
        }
        getBirthday(){
            return this.birthday;
        }
        getEmail(){
            return this.email;
        }
        getPhoneNumber(){
            return this.phoneNumber;
        }
        getLevel() {
            return this.level;
        }
        getPosition(){
            return this.position;
        }
        salary(){
            let salary;
            if (this.getPosition() === "Manager") {
                salary = 500;
            } else if (this.getPosition() === "Sale") {
                salary = 300;
            } else if (this.getPosition() === "Marketing") {
                salary = 200;
            }
            return salary;
        }
        getInfo() {
            return '1. Tên : ' + this.name + '\n2. Số CMND : ' + this.id + '\n3. Ngày tháng năm sinh : ' + this.birthday +
                '\n4. Email : ' + this.email + "\n5. Số điện thoại : " + this.phoneNumber +  "\n6. Trình độ : " + this.level +
                '\n7. Chức vụ : ' + this.position + '\n8. Phụ cấp : ' + this.salary()  + " $.";
        }
    }


    let customer1 = new customers("huynh duc hiep","201570268","15/04/1990","duchiep154@gmail.com","Da Nang","Diamond","10","2","5","Villa","vip");
    listCustomers.push(customer1);
    let employer1 = new Employee("huỳnh đức phát","205623789","26/02/1998","ducphat262@gmail.com","0935100007","Đại học","Manager");
    let employer2 = new Employee("huỳnh văn B","205643789","26/09/1998","ducphatsd262@gmail.com","0935450007","Đại học","Sale");
    let employer3 = new Employee("huỳnh văn c","205563789","26/08/1998","ducphatsdsd262@gmail.com","0935890007","Đại học","Makerting");
    let employer4 = new Employee("huynh văn t","201578999","26/08/1995","abc@abc.com","0905123456","dai hoc","Manager");
    listEmployers.push(employer1);
    listEmployers.push(employer2);
    listEmployers.push(employer3);
    listEmployers.push(employer4);





    function displayMainMenu() {
        let choose =parseInt(prompt('Nhập thao tác muốn thực hiện :\n' +
            '1. Add New Customer.\n' +
            '2. Display Information Customer.\n' +
            '3. Display total pay of customer \n' +
            '4. Edit Information Customer.\n' +
            '5. Delete Customer.\n' +
            '6.add employer \n'+
            '7. hien thi Employer.\n'));
        switch (choose) {

            case 1:
                addNewCustomer(listCustomers);
                displayMainMenu();
                break;
            case 2:

                displayCustomer(listCustomers);

                displayMainMenu();
                break;
            case 3:
                displayTotalPay(listCustomers);

                displayMainMenu();
                break;
            case 4:
                editCustomer(listCustomers);
                displayMainMenu();


                break;
            case 5:
                deleteCustomer(listCustomers);
                displayMainMenu();


                break;
            case 6 :
                addEmployer(listEmployers);
                displayMainMenu();


                break;
            case 7 :
                displayEmployer(listEmployers);
                displayMainMenu();
                break;

            default :
                if (choose===null){
                    return false;
                }
                else {
                    alert('Yêu cầu không có trong menu !');
                    displayMainMenu();
                    break;
                }

        }
    }





    // hàm add customer
    function addNewCustomer(array) {
        let name = prompt('Nhập Tên :');
        let id = "";
        do {
            id = prompt("Nhập CMND :");
            if (regexID.test(id)){
                break;
            }
            else alert("Định dạng CMND sai !"+"\n"+"CMND phải có 9 số !");
        }while (1);
        let birthday;
        do {
            birthday = prompt("Nhập ngày , tháng , năm sinh theo định dạng : DD/MM/YYYY");
            if (regexBirthday.test(birthday)) {
                break;
            }else alert("Ngày , tháng , năm sinh không hợp lệ !");
        } while (1);
        let email;
        do {
            email = prompt("Nhập email :");
            if (regexEmail.test(email)) {
                break;
            }else alert("Email của bạn không hợp lệ !");
        } while (1);
        let address = prompt("Nhập địa chỉ :\nTên Thành phố :");
        let typeCustomer = prompt("Nhập loại Customer :\nDiamond, Platinum, Gold, Silver, Member");
        let discount;
        do {
            discount = prompt("Nhập phần trăm giảm giá :\n1.Giá trị từ 0 - 100 Đơn vị (%)");
            if (!isNaN(discount) && discount >= 0 && discount <= 100 && discount !== ""){
                break;
            }else alert("Số liệu giảm giá của bạn không hợp lý !");
        }while (1);
        let quantityIncluded = parseInt(prompt("Nhập số người đi kèm :"));
        let typeRoom;
        do {
            typeRoom = prompt("Nhập loại phòng :\nVilla : 500$ / 1 ngày \nHouse : 300$ / 1 ngày\nRoom : 100$ / 1 ngày");
            if (typeRoom === "Villa" || typeRoom === "House" || typeRoom === "Room"){
                break;
            }else alert("vui lòng nhập 1 trong 3 loại phòng trên!")
        }while (1);
        let rentDay;
        do {
            rentDay = parseInt(prompt("Nhập số ngày thuê :"));
            if (rentDay > 0){
                break;
            }else alert("Số ngày thuê của bạn không hợp lý !");
        }while (1);
        let serviceRoom = prompt("Nhập loại phòng :\nVip , Business , Normal");
        let objCustomer = new customers(name,id,birthday,email,address,typeCustomer,discount,quantityIncluded,rentDay,typeRoom,serviceRoom);
        listCustomers.push(objCustomer);
        return alert(objCustomer.getInfo());
    }

    // ham  ten voi id de hien thi thong tin
    function showNameId(array) {
        let nameId = "";
        soThuTu=1;
        for (let i=0; i < array.length ;i++){
            nameId += soThuTu + '. ' + "ten :" + array[i].getName() + " \n id : " + array[i].getId() + "\n";
            soThuTu++;
        }
        return nameId;
    }
    // ham chon ten voi id
    function chonNameId(array) {
        let showNameID= showNameId(array);
        let chonName;
        do{
            chonName = parseInt(prompt("chọn người bạn muốn thực hiện: \n "+ showNameID + soThuTu + " .back"));
            if (chonName > 0 && chonName <= soThuTu){
                return chonName;
            }
            else {
                alert("lua chon ko dung moi nhap lai")
            }
        }while (1);
    }

    // ham lay thong tin display
    function info(array) {
        return array.getInfo();

    }



    // hàm hiển thị Customer
    function displayCustomer(array) {
        let chonName=chonNameId(array);
        if (chonName === soThuTu){
            return displayMainMenu();
        }else {
            return alert(info(array[chonName-1]));
        }
    }

    // ham edit customer

    function editCustomer(array) {
        let chonName = chonNameId(array);
        if (chonName === soThuTu) {
            return displayMainMenu();
        }
        else {
            let informationCustomer =info(array[chonName-1]);
            let check = true;
            do {
                check = true;
                let chonEdit=parseInt(prompt("chon thong tin muon sua :\n" + informationCustomer + "\12 .back"));
                switch (chonEdit) {
                    case 1 :{
                        let name = prompt('Nhập Tên :');
                        array[chonName-1].setName(name);
                        break;

                    }
                    case 2 :{
                        let id = "";
                        do {
                            id = prompt("Nhập CMND :");
                            if (regexID.test(id)){
                                break;
                            }
                            else alert("Định dạng CMND sai !"+"\n"+"CMND phải có 9 số !");
                        }while (1);
                        array[chonName-1].setId(id);
                        break;
                    }
                    case 3 :{
                        let birthday;
                        do {
                            birthday = prompt("Nhập ngày , tháng , năm sinh theo định dạng : DD/MM/YYYY");
                            if (regexBirthday.test(birthday)) {
                                break;
                            }else alert("Ngày , tháng , năm sinh không hợp lệ !");
                        } while (1);
                        array[chonName-1].setBirthday(birthday);
                        break;

                    }
                    case 4 :{
                        let email;
                        do {
                            email=prompt("nhap lai email");
                        }while (1);
                        array[chonName-1].setEmail(email);
                        break;

                    }
                    case 5 :{
                        let address=prompt("nhap lai dia chi");
                        array[chonName-1].setAddress(address);
                        break;

                    }
                    case 6 :{
                        let typeCustomer = prompt("Nhập loại Customer :\nDiamond, Platinum, Gold, Silver, Member");
                        array[chonName-1].setTypeCustomer(typeCustomer);
                        break;

                    }
                    case 7 :{
                        let discount = prompt("nhap gia tri % giam gia");
                        array[chonName-1].setDiscount(discount);
                        break;

                    }
                    case 8 :{
                        let quantityIncluded = parseInt(prompt("Nhập số người đi kèm :"));
                        array[chonName-1].setQuantityIncluded(quantityIncluded);
                        break;

                    }
                    case 9 :{
                        let typeRoom;
                        do {
                            typeRoom = prompt("Nhập loại phòng :\nVilla : 500$ / 1 ngày \nHouse : 300$ / 1 ngày\nRoom : 100$ / 1 ngày");
                            if (typeRoom === "Villa" || typeRoom === "House" || typeRoom === "Room"){
                                break;
                            }else alert("vui lòng nhập 1 trong 3 loại phòng trên!")
                        }while (1);
                        array[chonName-1].setTypeRoom(typeRoom);
                        break;

                    }
                    case 10 :{
                        rentDay = parseInt(prompt("Nhập số ngày thuê :"));
                        array[chonName-1].setRentDay(rentDay);
                        break;

                    }
                    case 11 :{
                        let serviceRoom = prompt("Nhập loại phòng :\nVip , Business , Normal");
                        array[chonName-1].setServiceRoom(serviceRoom);

                        break;

                    }
                    case 12 :{
                        displayMainMenu();
                        break;
                    }
                    default :
                        alert("vui long chon dung so thao tac can thuc hien");
                        check=false;
                        break;
                }
            }while (!check);
            return alert(info(array[chonName-1]));
        }

    }
    // ham delete customer
    function deleteCustomer(array) {
        let chonName=chonNameId(array);
        if (chonName === soThuTu){
            return displayMainMenu();
        }else {
            let confirm = parseInt(prompt("ban co muon xoa ko ?"+ "\n"+ "1.yes"+ "\n"+"2.no"));
            switch (confirm) {
                case 1 :{
                   return  array.splice((chonName-1),1);
                  //  return alert("da xoa thanh cong");
                }
                case 2 :
                    return deleteCustomer(array);

                default :
                    return deleteCustomer(array);
            }
        }
    }

    // hien thi thanh toan
    function displayTotalPay(array) {
        let chonName=chonNameId(array);
        if (chonName=== soThuTu){
            return displayMainMenu();
        }else {
            let totalPay= array[chonName-1].totalPay();
           return alert("so tien customer phai tra :" + totalPay + "$");
        }

    }



    // hàm add employer
    function addEmployer() {
        let name = prompt('Nhập Tên :');
        let id= "";
        do {
            id = prompt("Nhập CMND :");
            if (regexID.test(id)){
                break;
            }
            else alert("Định dạng CMND sai !"+"\n"+"CMND phải có 9 số !");
        }while (1);
        let birthday;
        do {
            birthday = prompt("Nhập ngày , tháng , năm sinh theo định dạng : DD/MM/YYYY");
            if (regexBirthday.test(birthday)) {
                break;
            }else alert("Ngày , tháng , năm sinh không hợp lệ !");
        } while (1);
        let email;
        do {
            email = prompt("Nhập email :");
            if (regexEmail.test(email)) {
                break;
            }else{
                alert("Email của bạn không hợp lệ !");
            }
        } while (1);

        let phoneNumber = '';
        do {
            let phoneNumber = prompt("nhập số điện thoại");
            if (regexPhoneNumber.test(phoneNumber)){
                break;
            }else {
                alert("so dt nhap ko dung");
            }
        } while (1);
        let level = prompt("Nhập trình độ : ");
        let position= prompt("nhập chức vụ :");
        let objEmployer = new Employee(name, id, birthday, email, phoneNumber,level,position);
        listEmployers.push(objEmployer);
        return alert(objEmployer.getInfo());

    }
    function chonNameIdEmployer(array) {
        let employerNameId = showNameId(array);
        let chonEmployer;
        do {
            let chonEmployer = parseInt(prompt("chon nhan vien ban muon xem :\n"+ employerNameId + soThuTu + ".back"));
            if (chonEmployer >0 && chonEmployer <= soThuTu){
                return chonEmployer;
            }else {
                alert("lua chon ko dung");
            }
        }while (1);


    }

  //  function infoEmployer(array) {
    //    return array.getInfo();


    function displayEmployer(array) {
        let chonEmployer = chonNameIdEmployer(array);
        if (chonEmployer === soThuTu){
            return displayMainMenu();
        }else {
            return alert(info(array[chonEmployer-1]));
        }
    }



    displayMainMenu();

</script>
</body>
</html>